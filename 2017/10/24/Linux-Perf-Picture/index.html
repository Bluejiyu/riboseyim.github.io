<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>Linux 性能诊断:荐书《图解性能优化》 | Ribose Yim&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="摘要 性能分析的基础:吞吐和响应的区别 实际系统中的性能分析 性能调优 性能测试 虚拟化环境下的性能 云环境下的性能">
<meta name="keywords" content="DevOps,Linux,SRE">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux 性能诊断:荐书《图解性能优化》">
<meta property="og:url" content="http://riboseyim.github.com/2017/10/24/Linux-Perf-Picture/index.html">
<meta property="og:site_name" content="Ribose Yim&#39;s Blog">
<meta property="og:description" content="摘要 性能分析的基础:吞吐和响应的区别 实际系统中的性能分析 性能调优 性能测试 虚拟化环境下的性能 云环境下的性能">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_suanfa_7.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_A_1.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_A_2-7.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_S_1.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_S_1_2.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_device_1.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_device_2.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_device_3.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_device_3_12.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_N_1.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_Copy_1.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_Process_1.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_Test_1.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_Test_Day_1.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_VM_1.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_VMM_TYPE_1.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_VM_RES_1.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_VM_RES_2.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_VM_Cloud.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_Cloud_deploy_1.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_front_web.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_Store_Change.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_VM_Cloud.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_Network_Change.png">
<meta property="og:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_Network_Change_2.png">
<meta property="og:image" content="http://og2061b3n.bkt.clouddn.com/ebook-linuxperfmaster-1.png">
<meta property="og:updated_time" content="2017-12-22T05:26:26.984Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Linux 性能诊断:荐书《图解性能优化》">
<meta name="twitter:description" content="摘要 性能分析的基础:吞吐和响应的区别 实际系统中的性能分析 性能调优 性能测试 虚拟化环境下的性能 云环境下的性能">
<meta name="twitter:image" content="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_suanfa_7.png">
  
    <link rel="alternative" href="/atom.xml" title="Ribose Yim&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="http://o8m8ngokc.bkt.clouddn.com/icon_cangshu.jpg">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://o8m8ngokc.bkt.clouddn.com/icon_macbook.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">RiboseYim</a></h1>
		</hgroup>

		
		<p class="header-subtitle">愿交天下士，罄我怀中藏。</p>
		

		<form id="search-form" class="search">  <!-- 搜索框相关 -->
    <input type="text" id="st-search-input" name="q" results="0" class="st-default-search-input" maxlength="30" placeholder="Search..." autocomplete="off" autocorrect="off">
		</form>
		<div id="local-search-result"></div> <!-- 搜索结果区 -->
	  <p class='no-result'>No results found </p> 

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>

				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						<li>Links</li>
						
						
						<li>About</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/tags/DevOps">DevOps</a></li>
				        
							<li><a href="/tags/架构师">架构师</a></li>
				        
							<li><a href="/tags/讲武堂">讲武堂</a></li>
				        
							<li><a href="/tags/Economist">经济学人</a></li>
				        
							<li><a href="/tags/Policy-Law">Policy&amp;Law</a></li>
				        
							<li><a href="/tags/Art">艺术评论</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="twitter" target="_blank" href="https://twitter.com/RiboseYim" title="twitter">twitter</a>
					        
								<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/riboseyim" title="zhihu">zhihu</a>
					        
								<a class="github" target="_blank" href="https://github.com/riboseyim" title="github">github</a>
					        
								<a class="linkedin" target="_blank" href="http://www.linkedin.com/in/%E7%9D%BF-%E4%B8%A5-b39028110" title="linkedin">linkedin</a>
					        
						</div>
					</nav>
				</section>

				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Art/" style="font-size: 15.26px;">Art</a> <a href="/tags/Books/" style="font-size: 10px;">Books</a> <a href="/tags/Cyber-Security/" style="font-size: 14.21px;">Cyber-Security</a> <a href="/tags/DTrace/" style="font-size: 11.58px;">DTrace</a> <a href="/tags/DevOps/" style="font-size: 20px;">DevOps</a> <a href="/tags/Developer/" style="font-size: 18.42px;">Developer</a> <a href="/tags/Develper/" style="font-size: 10px;">Develper</a> <a href="/tags/Economist/" style="font-size: 17.37px;">Economist</a> <a href="/tags/Education/" style="font-size: 10px;">Education</a> <a href="/tags/Golang/" style="font-size: 13.68px;">Golang</a> <a href="/tags/Health/" style="font-size: 10.53px;">Health</a> <a href="/tags/History/" style="font-size: 16.84px;">History</a> <a href="/tags/Lincoln/" style="font-size: 10.53px;">Lincoln</a> <a href="/tags/Linux/" style="font-size: 17.89px;">Linux</a> <a href="/tags/Machine-Learning/" style="font-size: 15.79px;">Machine-Learning</a> <a href="/tags/Manager/" style="font-size: 16.84px;">Manager</a> <a href="/tags/Medical/" style="font-size: 13.68px;">Medical</a> <a href="/tags/Nodejs/" style="font-size: 11.05px;">Nodejs</a> <a href="/tags/OpenSource/" style="font-size: 14.74px;">OpenSource</a> <a href="/tags/PHT/" style="font-size: 11.05px;">PHT</a> <a href="/tags/Policy-Law/" style="font-size: 18.95px;">Policy&Law</a> <a href="/tags/SDN/" style="font-size: 13.16px;">SDN</a> <a href="/tags/SRE/" style="font-size: 15.79px;">SRE</a> <a href="/tags/Science/" style="font-size: 14.74px;">Science</a> <a href="/tags/Sport/" style="font-size: 11.58px;">Sport</a> <a href="/tags/Writing/" style="font-size: 10.53px;">Writing</a> <a href="/tags/工具癖/" style="font-size: 12.11px;">工具癖</a> <a href="/tags/我的自传/" style="font-size: 12.63px;">我的自传</a> <a href="/tags/摄影/" style="font-size: 11.58px;">摄影</a> <a href="/tags/数学与算法/" style="font-size: 14.74px;">数学与算法</a> <a href="/tags/数据可视化/" style="font-size: 14.21px;">数据可视化</a> <a href="/tags/数据库/" style="font-size: 10.53px;">数据库</a> <a href="/tags/最佳写作实践/" style="font-size: 13.68px;">最佳写作实践</a> <a href="/tags/最佳工程实践/" style="font-size: 16.84px;">最佳工程实践</a> <a href="/tags/架构师/" style="font-size: 19.47px;">架构师</a> <a href="/tags/科技史/" style="font-size: 10.53px;">科技史</a> <a href="/tags/移动互联网/" style="font-size: 10px;">移动互联网</a> <a href="/tags/红学/" style="font-size: 11.05px;">红学</a> <a href="/tags/网络协议/" style="font-size: 16.32px;">网络协议</a> <a href="/tags/讲武堂/" style="font-size: 13.68px;">讲武堂</a>
					</div>
				</section>
				

				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.jianshu.com/c/f2ea0605db4b">专题-经济学人翻译社</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://www.gitbook.com/book/riboseyim/linux-perf-master/details">电子书《Linux Perf Master》</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.jianshu.com/c/9a817d8a67ea">简书专题-系统运维专家</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.jianshu.com/c/0886ffd76168">简书专题-网络与信息安全</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.jianshu.com/c/9ae32222e422">简书专题-操作系统与动态追踪技术</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.jianshu.com/c/8d40a3a05825">简书专题-数据可视化</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://riboseyim.github.io/2017/11/16/QuickStart/">快捷目录</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://riboseyim.github.io/2017/05/26/Catalog/">总目录</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">Engineer &amp; Writer</div>
				</section>
				
			</div>
		</div>
	</header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">RiboseYim</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="http://o8m8ngokc.bkt.clouddn.com/icon_macbook.jpg" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">RiboseYim</h1>
			</hgroup>
			
			<p class="header-subtitle">愿交天下士，罄我怀中藏。</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/tags/DevOps">DevOps</a></li>
		        
					<li><a href="/tags/架构师">架构师</a></li>
		        
					<li><a href="/tags/讲武堂">讲武堂</a></li>
		        
					<li><a href="/tags/Economist">经济学人</a></li>
		        
					<li><a href="/tags/Policy-Law">Policy&amp;Law</a></li>
		        
					<li><a href="/tags/Art">艺术评论</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="twitter" target="_blank" href="https://twitter.com/RiboseYim" title="twitter">twitter</a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/riboseyim" title="zhihu">zhihu</a>
			        
						<a class="github" target="_blank" href="https://github.com/riboseyim" title="github">github</a>
			        
						<a class="linkedin" target="_blank" href="http://www.linkedin.com/in/%E7%9D%BF-%E4%B8%A5-b39028110" title="linkedin">linkedin</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap"><article id="post-Linux-Perf-Picture" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/10/24/Linux-Perf-Picture/" class="article-date">
  	<time datetime="2017-10-24T03:35:44.000Z" itemprop="datePublished">2017-10-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Linux 性能诊断:荐书《图解性能优化》
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DevOps/">DevOps</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SRE/">SRE</a></li></ul>
	</div>

        


        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><ul>
<li>性能分析的基础:吞吐和响应的区别</li>
<li>实际系统中的性能分析</li>
<li>性能调优</li>
<li>性能测试</li>
<li>虚拟化环境下的性能</li>
<li>云环境下的性能<a id="more"></a>
</li>
</ul>
<h3 id="一、性能分析的基础"><a href="#一、性能分析的基础" class="headerlink" title="一、性能分析的基础"></a>一、性能分析的基础</h3><ul>
<li><p>响应和吞吐的区别（初学者可能经常会混淆的概念）<br>响应：表示应答的快慢<br>吞吐：表示处理数量的多少<br>案例：“明明优化了机器的配置，但性能并没有提高”。响应有问题，却增加了CPU核心数，只是增加了空转的CPU核心而已。所以要养成习惯，先确认问题是出在响应还是吞吐上。<br><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_suanfa_7.png" alt=""></p>
</li>
<li><p>性能分析从测量开始，性能必须是能够测量的<br>性能信息的3种类型：<br>1、概要形式:例如sar、vmstat,作为入手点调查过去发生了什么，“现象”<br>2、事件记录形式:例如网络抓包（Packet Capture）<br>3、快照（Snapshot）：例如ps和top</p>
</li>
</ul>
<p><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_A_1.png" alt=""><br><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_A_2-7.png" alt=""></p>
<ul>
<li><p>扩展阅读：<a href="http://www.jianshu.com/p/fd6e35f529c1" target="_blank" rel="external">《Linux性能分析模型－In 60 Seconds》</a></p>
</li>
<li><p>性能分析中的重要理论：等待队列理论<br>从性能的稳定性方面来考虑，带宽控制思维方式。<br><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_S_1.png" alt=""><br><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_S_1_2.png" alt=""></p>
</li>
</ul>
<h3 id="二、实际系统中的性能分析"><a href="#二、实际系统中的性能分析" class="headerlink" title="二、实际系统中的性能分析"></a>二、实际系统中的性能分析</h3><h4 id="AP服务器的性能测量"><a href="#AP服务器的性能测量" class="headerlink" title="AP服务器的性能测量"></a>AP服务器的性能测量</h4><p>不同语言的性能信息获取: Java：GC（垃圾回收）日志 ，全GC（Stop the world）</p>
<h4 id="DB服务器的性能测量"><a href="#DB服务器的性能测量" class="headerlink" title="DB服务器的性能测量"></a>DB服务器的性能测量</h4><p>DB服务器本身的特点就是集中管理数据，需要频繁地查看线程（会话）之间的交互，因此很容易出现资源竞争的情况，因此在进行DBMS性能分析的时候，一定要考虑多个线程的存在。</p>
<h4 id="存储性能分析的思路"><a href="#存储性能分析的思路" class="headerlink" title="存储性能分析的思路"></a>存储性能分析的思路</h4><p>思路：重视IOPS<br>术语：响应时间、IOPS（Input Output Per Second）<br>类型：物理磁盘、SSD</p>
<p>缓存命中率：在存储的世界里，磁盘、存储、OS等各处都存在着缓存，使用缓存命中率作为表示缓存工作效率的指标。<br>脏数据（或者脏数据块）：已经更新但没有写入的数据。脏数据不可以丢弃，如果在缓存上堆积了大量的脏数据，I／O就无法有效运作，进而就会导致问题的发生。</p>
<p><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_device_1.png" alt=""><br><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_device_2.png" alt=""><br><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_device_3.png" alt=""><br><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_device_3_12.png" alt=""></p>
<h4 id="网络性能分析的思路"><a href="#网络性能分析的思路" class="headerlink" title="网络性能分析的思路"></a>网络性能分析的思路</h4><p><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_N_1.png" alt="ACK机制"></p>
<h4 id="调查原因"><a href="#调查原因" class="headerlink" title="调查原因"></a>调查原因</h4><ul>
<li>陷阱1:关注受害者，“疑犯”与“真凶”</li>
<li>陷阱2:没有意识到基础不稳 （自下而上）</li>
<li>陷阱3:没有注意到负载的变化</li>
<li>陷阱4:不能确定谁拿着球</li>
<li>陷阱5:不能确定因果关系<br><strong>很多人不能把握原因，而只是随便瞎猜一下就进行调优。</strong><br>掌握因果关系的一个窍门是学习架构知识。知道了机制后就能减少错误分析的情况。另外，从逻辑上来考虑因果关系是很重要的。要试着思考一下“这个现象能否解释另一个现象”。</li>
</ul>
<h3 id="三、性能调优"><a href="#三、性能调优" class="headerlink" title="三、性能调优"></a>三、性能调优</h3><ul>
<li>调优要循序渐进：先把大石头移开。</li>
<li><p>具体思路：<br>1、重复使用：连接池、PreparedStatement、线程池<br>2、汇总处理：集中、Piggyback<br>3、提高速度和实现并行<br>4、纵向扩展（Scale Up）与横向扩展（Scale Out）：</p>
</li>
<li><p>应用技巧：<br>1、省略循环<br>2、访问频率高的数据存放入键值存储<br>3、访问频率高的数据存放在使用位置附近<br>4、把同步变成异步<br>5、带宽控制<br>6、LRU算法<br>7、分割处理或者细化锁的力度<br>8、回写缓存、多层缓存<br>9、巨帧和高速网络<br>10、负载均衡 <a href="https://riboseyim.github.io/2016/09/01/AAA/" target="_blank" rel="external">基于LVS的AAA负载均衡架构实践</a><br>11、写时复制</p>
</li>
</ul>
<p><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_Copy_1.png" alt=""></p>
<h3 id="四、性能测试"><a href="#四、性能测试" class="headerlink" title="四、性能测试"></a>四、性能测试</h3><p><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_Process_1.png" alt=""></p>
<h4 id="项目工程环境"><a href="#项目工程环境" class="headerlink" title="项目工程环境"></a>项目工程环境</h4><p>基于项目整理来确保应用程序的性能。</p>
<p>应用程序设计负责人一般不会考虑系统整体的性能，而是满脑子考虑如何使用新的框架和中间件来实现需要的业务和功能。</p>
<h4 id="常见的失败情况：9种反面模式"><a href="#常见的失败情况：9种反面模式" class="headerlink" title="常见的失败情况：9种反面模式"></a>常见的失败情况：9种反面模式</h4><ul>
<li>不能在期限内完成</li>
<li>性能很差！解决不了性能问题</li>
<li>由于没有考虑到环境差异而导致发生问题</li>
<li>压力场景设计不完备导致发生问题</li>
<li>没有考虑到缓冲、缓存的时候而导致发生问题</li>
<li>没有考虑到思考时间而导致发生问题</li>
<li>报告内容难以理解导致客户不能认同</li>
<li>客户因为存在不信任感而不能认同</li>
<li>测试很花时间</li>
</ul>
<p>后期工程中隐藏着性能问题，原因如下：</p>
<ul>
<li>只有在生产环境中才会出现</li>
<li>问题的显现需要很多条件（环境、数据、负载生成）</li>
<li>因为特定的操作才导致发生性能问题</li>
</ul>
<p>==&gt;&gt;为系统中的性能测试流出一个月的时间。</p>
<p>对横跨多个领域的性能问题进行排查的时候，如果不能综合多个领域来考虑，负责人就会一直说“我负责的那部分没有问题”，导致问题无法解决。</p>
<p>客户关心的焦点集中在“在实际生产环境中运行时是否会出现性能方面的问题”。</p>
<p>由于不能很好地共享性能测试地整体过程，或者本来关于性能需求或性能测试设计地需求等地约定就很模糊，导致结论与评价基准等也变得很模糊，引起沟通不畅。</p>
<p><a href="https://riboseyim.github.io/2016/06/12/Oracle/" target="_blank" rel="external">参考案例:Oracle数据库迁移割接实录</a></p>
<h4 id="需求定义"><a href="#需求定义" class="headerlink" title="需求定义"></a>需求定义</h4><p>三要素：吞吐（T）、响应时间（R）、用户并发度（U）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">U x R = T</div></pre></td></tr></table></figure>
<p>并发并不是作为性能目标通过听取客户意见来推导出来的，而是通常根据吞吐和响应时间计算出一个合适的值（客户即使了解业务中同时使用的人数，但是对于系统瞬间运行的并发处理的情况，他们并不清楚）。</p>
<h4 id="集成测试：多并发运行测试"><a href="#集成测试：多并发运行测试" class="headerlink" title="集成测试：多并发运行测试"></a>集成测试：多并发运行测试</h4><h4 id="系统测试：压力测试、临界测试、耐久测试"><a href="#系统测试：压力测试、临界测试、耐久测试" class="headerlink" title="系统测试：压力测试、临界测试、耐久测试"></a>系统测试：压力测试、临界测试、耐久测试</h4><h4 id="运维测试：性能监控测试、故障测试"><a href="#运维测试：性能监控测试、故障测试" class="headerlink" title="运维测试：性能监控测试、故障测试"></a>运维测试：性能监控测试、故障测试</h4><p><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_Test_1.png" alt=""><br><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_Test_Day_1.png" alt=""></p>
<h3 id="五、虚拟化环境下的性能"><a href="#五、虚拟化环境下的性能" class="headerlink" title="五、虚拟化环境下的性能"></a>五、虚拟化环境下的性能</h3><p>在虚拟化环境中，多个VM（虚拟机）运行在一台服务器上，因此可以更加有效地共享资源，有利于削减成本。而反过来，若资源被共享过度，则会发生竞争，可能导致性能的下降。因此，在资源效率和性能之间取得平衡就变得尤为重要。<br><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_VM_1.png" alt=""><br><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_VMM_TYPE_1.png" alt=""><br><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_VM_RES_1.png" alt=""><br><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_VM_RES_2.png" alt=""></p>
<h4 id="虚拟化的性能管理（CPU）"><a href="#虚拟化的性能管理（CPU）" class="headerlink" title="虚拟化的性能管理（CPU）"></a>虚拟化的性能管理（CPU）</h4><p>虚拟环境下Guest OS发出的特权命令会被更改，因此和物理环境相比需要更多的处理时间。另外，物理环境下也不需要将逻辑CPU分配个VM的调度处理，如果CPU的分配发生了竞争，这个等待时间就会影响性能。</p>
<p><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_VM_Cloud.png" alt=""></p>
<h3 id="六、云计算环境下的性能"><a href="#六、云计算环境下的性能" class="headerlink" title="六、云计算环境下的性能"></a>六、云计算环境下的性能</h3><ul>
<li>构成计算资源的技术元素并没有大的变化</li>
<li>网络访问和资源的使用及提供形态发生了变化</li>
<li>LAN网络的变化</li>
<li>WAN网络的变化</li>
</ul>
<p><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_Cloud_deploy_1.png" alt=""></p>
<p>云计算的一个大的变化就是LAN网络。具体来说，本地部署环境下物理路由器和交换机实现的部分被隐藏起来，通过虚拟的网络来组成。</p>
<p>WAN连接方法：<br>1、专线连接：主要依赖于所选择的通信运营商的服务特性，带宽保证和性能的成本与之前相比并没有太大变化。<br>2、互联网连接：云计算服务可以非常优惠的加个来利用共享的互联网带宽，可以减轻高峰时带宽限制的顾虑。云计算服务中提供的CDN（Contents Delivery Network）或Global DNS等功能，能够很方便地提高互联网服务的速度。</p>
<p><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_front_web.png" alt=""></p>
<p>随着存储的网络化，直接连接到普通的LAN的情况也越来越多，磁盘I/O变为网络I／O的情况也越来越多。在NAS（Network Attached Storage）以及云环境下，磁盘I/O在普通的TCP／IP网络中完成的情况也很多。（具体第7章）</p>
<p><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_Store_Change.png" alt=""></p>
<p><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_VM_Cloud.png" alt=""></p>
<p><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_Network_Change.png" alt=""><br><img src="http://omb2onfvy.bkt.clouddn.com/ChartPerf_512_Network_Change_2.png" alt=""></p>
<h4 id="云计算环境中开发阶段的思维方式"><a href="#云计算环境中开发阶段的思维方式" class="headerlink" title="云计算环境中开发阶段的思维方式"></a>云计算环境中开发阶段的思维方式</h4><p>在云计算环境下，比起技术方面的差异，思维方式上的差异更为明显。在实际业务层面最大的变化就是对以往的以硬件配置为前提的开发运维流程的影响。</p>
<p>1、基本设计：估算（Sizing）<br>2、系统测试：性能测试<br>3、项目管理</p>
<p>云计算环境中不需要准备硬件，但是并不代表不需要进行估算。<br>观点一：成本估算。成本会根据选定的资源大小而有所变化。<br>观点二：临界估算。在本地部署环境下，企业级系统很多都是集中式的处理方式，如果按照这种方式原封不懂地迁移到云计算环境，可能就会碰到瓶颈，为了消除这种风险，就需要进行估算，考虑临界容量的可实现性。</p>
<p><strong>POC：Proof of Concept (概念验证)</strong><br>云计算的情况下，能在瞬间准备好多种模式的环境用于验证，可通过POC来验证运行情况、搭建模式与费用。</p>
<p>在云计算环境下，容量管理与成本管理是一体的。</p>
<p>云计算服务的核心是根据负载使用量收费。由于这种收费模式，原来只有工程师会关注的传送量、I／O数、HTTP请求数等详细的性能指标数据会直接反映在费用上，因此需要经营者掌握这些性能指标及其含义。使用云计算后，容量与成本就联系到一起，因此云计算可能是促使经营者学习容量分析的一个有效手段。</p>
<p>运维：除了应对峰值，在没有业务流量的时间段内动态削减多余的资源，降低成本，也是很有价值的。</p>
<h2 id="扩展阅读：Linux-操作系统"><a href="#扩展阅读：Linux-操作系统" class="headerlink" title="扩展阅读：Linux 操作系统"></a>扩展阅读：Linux 操作系统</h2><ul>
<li><a href="https://riboseyim.github.io/2016/04/24/LinusTorvalds/" target="_blank" rel="external">《Linus Torvalds:Just for Fun》</a></li>
<li><a href="https://riboseyim.github.io/2017/04/26/Linux-Commands/" target="_blank" rel="external">Linux 常用命令一百条</a></li>
<li><a href="https://riboseyim.github.io/2017/12/11/Linux-Perf-Load/" target="_blank" rel="external">Linux 性能诊断:负载评估</a></li>
<li><a href="https://riboseyim.github.io/2017/12/11/Linux-Perf-Netflix/" target="_blank" rel="external">Linux 性能诊断:快速检查单(Netflix版)</a></li>
<li><a href="https://riboseyim.github.io/2017/10/24/Linux-Perf-Picture/" target="_blank" rel="external">Linux 性能诊断：荐书|《图解性能优化》</a></li>
<li><a href="https://riboseyim.github.io/2017/10/24/Linux-Perf-Wan/" target="_blank" rel="external">Linux 性能诊断：Web应用性能优化</a></li>
<li><a href="https://riboseyim.github.io/2017/05/29/Linux-Works/" target="_blank" rel="external">操作系统原理 | How Linux Works（一）：How the Linux Kernel Boots</a></li>
<li><a href="https://riboseyim.github.io/2017/05/29/Linux-Works/" target="_blank" rel="external">操作系统原理 | How Linux Works（二）：User Space &amp; RAM</a></li>
<li><a href="https://riboseyim.github.io/2017/12/11/Linux-Works-Memory/" target="_blank" rel="external">操作系统原理 | How Linux Works（三）：Memory</a></li>
</ul>
<h2 id="推荐：电子书《Linux-Perf-Master》"><a href="#推荐：电子书《Linux-Perf-Master》" class="headerlink" title="推荐：电子书《Linux Perf Master》"></a>推荐：电子书《Linux Perf Master》</h2><p>发表在GitBook平台，欢迎订阅、下载、批评指正: <a href="https://www.gitbook.com/book/riboseyim/linux-perf-master/details" target="_blank" rel="external">https://www.gitbook.com/book/riboseyim/linux-perf-master/details</a></p>
<p><img src="http://og2061b3n.bkt.clouddn.com/ebook-linuxperfmaster-1.png" alt=""></p>

      

    </div>
    
  </div>
  
    <div class="article-entry" itemprop="articleBody">
      <p>
        更多精彩内容扫码关注公众号,RiboseYim's Blog：<a href="https://riboseyim.github.io" target="_blank" rel="external">https://riboseyim.github.io</a>
        <br>
        <a href="http://o8m8ngokc.bkt.clouddn.com/ID_RiboseYim_201706.png" title="微信公众号@睿哥杂货铺" rel="fancy-group" class="fancy-ctn fancybox">
          <img src="http://o8m8ngokc.bkt.clouddn.com/ID_RiboseYim_201706.png" title="微信公众号@睿哥杂货铺">
          <img src="http://o8m8ngokc.bkt.clouddn.com/quanzi-rui-small.png" title="睿哥读书会">
        </a>
      </p>
    </div>
    
<nav id="article-nav">
  
    <a href="/2017/10/29/CyberSecurity-WiFi/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          Cyber-Security:警惕Wi-Fi漏洞
        
      </div>
    </a>
  
  
    <a href="/2017/10/24/Linux-Perf-Wan/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Linux 性能诊断:Web 应用性能优化</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		  <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" target="_blank">Copyright 2016-2018 RiboseYim
      授权：保持署名-非商业性使用-禁止演绎| License BY-NC-ND 4.0 </a>
    </div>
      	<div class="footer-right">
      		<a href="https://riboseyim.github.io/2016/05/31/AboutMe/" target="_blank"> 联系作者 </a>
      	</div>
    </div>
  </div>
</footer>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1258500076'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s4.cnzz.com/z_stat.php%3Fid%3D1258500076%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>

    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: true
	}
</script>
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  </div>
</body>
</html>