<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>网络数据包的捕获、过滤和分析（Packet Capturing） | Ribose Yim&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="摘要 Packet Capturing Overview What is Packet Capturing How can it be used What is libpcap Debug Tools: tcpdump &amp;amp; WinPcap &amp;amp; snoop What is BPF What is gopacket">
<meta name="keywords" content="DevOps,Linux,网络协议,Developer,Golang">
<meta property="og:type" content="article">
<meta property="og:title" content="网络数据包的捕获、过滤和分析（Packet Capturing）">
<meta property="og:url" content="http://riboseyim.github.com/2017/06/16/Network-Pcap/index.html">
<meta property="og:site_name" content="Ribose Yim&#39;s Blog">
<meta property="og:description" content="摘要 Packet Capturing Overview What is Packet Capturing How can it be used What is libpcap Debug Tools: tcpdump &amp;amp; WinPcap &amp;amp; snoop What is BPF What is gopacket">
<meta property="og:image" content="http://og2061b3n.bkt.clouddn.com/Packet_Capture_Overview.png">
<meta property="og:image" content="http://og2061b3n.bkt.clouddn.com/Packet_Capture_Flow_1.png">
<meta property="og:image" content="http://og2061b3n.bkt.clouddn.com/Packet_Capture_BPF.png">
<meta property="og:image" content="http://og2061b3n.bkt.clouddn.com/Packet_Capture_Flow_2.png">
<meta property="og:image" content="http://og2061b3n.bkt.clouddn.com/Network_Protocol_Packet.png">
<meta property="og:updated_time" content="2018-04-10T06:32:05.336Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="网络数据包的捕获、过滤和分析（Packet Capturing）">
<meta name="twitter:description" content="摘要 Packet Capturing Overview What is Packet Capturing How can it be used What is libpcap Debug Tools: tcpdump &amp;amp; WinPcap &amp;amp; snoop What is BPF What is gopacket">
<meta name="twitter:image" content="http://og2061b3n.bkt.clouddn.com/Packet_Capture_Overview.png">
  
    <link rel="alternative" href="/atom.xml" title="Ribose Yim&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="http://o8m8ngokc.bkt.clouddn.com/icon_cangshu.jpg">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://o8m8ngokc.bkt.clouddn.com/icon_macbook.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">RiboseYim</a></h1>
		</hgroup>

		
		<p class="header-subtitle">愿交天下士，罄我怀中藏。</p>
		

		<form id="search-form" class="search">  <!-- 搜索框相关 -->
    <input type="text" id="st-search-input" name="q" results="0" class="st-default-search-input" maxlength="30" placeholder="Search..." autocomplete="off" autocorrect="off">
		</form>
		<div id="local-search-result"></div> <!-- 搜索结果区 -->
	  <p class='no-result'>No results found </p> 

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>

				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						<li>Links</li>
						
						
						<li>Über</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/tags/DevOps">DevOps</a></li>
				        
							<li><a href="/tags/架构师">架构师</a></li>
				        
							<li><a href="/tags/讲武堂">讲武堂</a></li>
				        
							<li><a href="/tags/Economist">经济学人</a></li>
				        
							<li><a href="/tags/Policy-Law">Policy&amp;Law</a></li>
				        
							<li><a href="/tags/Art">艺术评论</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="twitter" target="_blank" href="https://twitter.com/RiboseYim" title="twitter">twitter</a>
					        
								<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/riboseyim" title="zhihu">zhihu</a>
					        
								<a class="github" target="_blank" href="https://github.com/riboseyim" title="github">github</a>
					        
								<a class="linkedin" target="_blank" href="http://www.linkedin.com/in/%E7%9D%BF-%E4%B8%A5-b39028110" title="linkedin">linkedin</a>
					        
						</div>
					</nav>
				</section>

				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Art/" style="font-size: 15.26px;">Art</a> <a href="/tags/Books/" style="font-size: 10px;">Books</a> <a href="/tags/Cyber-Security/" style="font-size: 14.21px;">Cyber-Security</a> <a href="/tags/DTrace/" style="font-size: 11.58px;">DTrace</a> <a href="/tags/DevOps/" style="font-size: 20px;">DevOps</a> <a href="/tags/Developer/" style="font-size: 18.42px;">Developer</a> <a href="/tags/Develper/" style="font-size: 10px;">Develper</a> <a href="/tags/Economist/" style="font-size: 17.37px;">Economist</a> <a href="/tags/Education/" style="font-size: 10px;">Education</a> <a href="/tags/Golang/" style="font-size: 13.68px;">Golang</a> <a href="/tags/Health/" style="font-size: 10.53px;">Health</a> <a href="/tags/History/" style="font-size: 16.84px;">History</a> <a href="/tags/Lincoln/" style="font-size: 10.53px;">Lincoln</a> <a href="/tags/Linux/" style="font-size: 17.89px;">Linux</a> <a href="/tags/Machine-Learning/" style="font-size: 15.79px;">Machine-Learning</a> <a href="/tags/Manager/" style="font-size: 16.84px;">Manager</a> <a href="/tags/Medical/" style="font-size: 13.68px;">Medical</a> <a href="/tags/Nodejs/" style="font-size: 11.05px;">Nodejs</a> <a href="/tags/OpenSource/" style="font-size: 14.21px;">OpenSource</a> <a href="/tags/PHT/" style="font-size: 11.05px;">PHT</a> <a href="/tags/Policy-Law/" style="font-size: 18.95px;">Policy&Law</a> <a href="/tags/SDN/" style="font-size: 13.16px;">SDN</a> <a href="/tags/SRE/" style="font-size: 15.79px;">SRE</a> <a href="/tags/Science/" style="font-size: 14.74px;">Science</a> <a href="/tags/Sport/" style="font-size: 11.58px;">Sport</a> <a href="/tags/Writing/" style="font-size: 10.53px;">Writing</a> <a href="/tags/工具癖/" style="font-size: 12.11px;">工具癖</a> <a href="/tags/我的自传/" style="font-size: 12.63px;">我的自传</a> <a href="/tags/摄影/" style="font-size: 11.58px;">摄影</a> <a href="/tags/数学与算法/" style="font-size: 14.74px;">数学与算法</a> <a href="/tags/数据可视化/" style="font-size: 14.21px;">数据可视化</a> <a href="/tags/数据库/" style="font-size: 10.53px;">数据库</a> <a href="/tags/最佳写作实践/" style="font-size: 13.68px;">最佳写作实践</a> <a href="/tags/最佳工程实践/" style="font-size: 16.84px;">最佳工程实践</a> <a href="/tags/架构师/" style="font-size: 19.47px;">架构师</a> <a href="/tags/科技史/" style="font-size: 10.53px;">科技史</a> <a href="/tags/移动互联网/" style="font-size: 10px;">移动互联网</a> <a href="/tags/红学/" style="font-size: 11.05px;">红学</a> <a href="/tags/网络协议/" style="font-size: 16.32px;">网络协议</a> <a href="/tags/讲武堂/" style="font-size: 13.68px;">讲武堂</a>
					</div>
				</section>
				

				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.jianshu.com/c/f2ea0605db4b">专题-经济学人翻译社</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://www.gitbook.com/book/riboseyim/linux-perf-master/details">电子书《Linux Perf Master》</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.jianshu.com/c/9a817d8a67ea">简书专题-系统运维专家</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.jianshu.com/c/0886ffd76168">简书专题-网络与信息安全</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.jianshu.com/c/9ae32222e422">简书专题-操作系统与动态追踪技术</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.jianshu.com/c/8d40a3a05825">简书专题-数据可视化</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://riboseyim.github.io/2017/11/16/QuickStart/">快捷目录</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://riboseyim.github.io/2017/05/26/Catalog/">总目录</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">Engineer &amp; Writer</div>
				</section>
				
			</div>
		</div>
	</header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">RiboseYim</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="http://o8m8ngokc.bkt.clouddn.com/icon_macbook.jpg" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">RiboseYim</h1>
			</hgroup>
			
			<p class="header-subtitle">愿交天下士，罄我怀中藏。</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/tags/DevOps">DevOps</a></li>
		        
					<li><a href="/tags/架构师">架构师</a></li>
		        
					<li><a href="/tags/讲武堂">讲武堂</a></li>
		        
					<li><a href="/tags/Economist">经济学人</a></li>
		        
					<li><a href="/tags/Policy-Law">Policy&amp;Law</a></li>
		        
					<li><a href="/tags/Art">艺术评论</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="twitter" target="_blank" href="https://twitter.com/RiboseYim" title="twitter">twitter</a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/riboseyim" title="zhihu">zhihu</a>
			        
						<a class="github" target="_blank" href="https://github.com/riboseyim" title="github">github</a>
			        
						<a class="linkedin" target="_blank" href="http://www.linkedin.com/in/%E7%9D%BF-%E4%B8%A5-b39028110" title="linkedin">linkedin</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap"><article id="post-Network-Pcap" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/06/16/Network-Pcap/" class="article-date">
  	<time datetime="2017-06-16T08:08:56.000Z" itemprop="datePublished">2017-06-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      网络数据包的捕获、过滤和分析（Packet Capturing）
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DevOps/">DevOps</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Developer/">Developer</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Golang/">Golang</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/网络协议/">网络协议</a></li></ul>
	</div>

        


        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><ul>
<li>Packet Capturing Overview</li>
<li>What is Packet Capturing</li>
<li>How can it be used</li>
<li>What is libpcap</li>
<li>Debug Tools: tcpdump &amp; WinPcap &amp; snoop</li>
<li>What is BPF</li>
<li>What is gopacket</li>
</ul>
<a id="more"></a>
<h2 id="What-is-Packet-Capturing"><a href="#What-is-Packet-Capturing" class="headerlink" title="What is Packet Capturing"></a>What is Packet Capturing</h2><p>Packet capture is a computer networking term for intercepting a data packet that is crossing or moving over a specific computer network.Once a packet is captured, it is stored temporarily so that it can be analyzed. The packet is inspected to help diagnose and solve network problems and determine whether network security policies are being followed.</p>
<p><img src="http://og2061b3n.bkt.clouddn.com/Packet_Capture_Overview.png" alt="Packet Capture Overview"></p>
<h2 id="How-can-it-be-used"><a href="#How-can-it-be-used" class="headerlink" title="How can it be used"></a>How can it be used</h2><ul>
<li><p>Development<br>Testing &amp; validating &amp; Reverse engineer APP on API</p>
</li>
<li><p>Network Administration<br>Seeing what traffic goes on in background,Looking for malicious traffic on networkData capturing is used to identify security flaws and breaches by determining the point of intrusion.</p>
</li>
<li><p>Troubleshooting<br>Managed through data capturing, troubleshooting detects the occurrence of undesired events over a network and helps solve them. If the network administrator has full access to a network resource, he can access it remotely and troubleshoot any issues.</p>
</li>
<li><p>Security<br>defcon Wall of Sheep.Hackers can also use packet capturing techniques to steal data that is being transmitted over a network, like Stealing credentials.When data is stolen, the network administrator can retrieve the stolen or lost information easily using data capturing techniques.</p>
</li>
<li><p>Forensics<br>forensics for crime investigations.Whenever viruses, worms or other intrusions are detected in computers, the network administrator determines the extent of the problem. After initial analysis, she may block some segments and network traffic in order to save historical information and network data.</p>
</li>
</ul>
<h2 id="What-is-libpcap"><a href="#What-is-libpcap" class="headerlink" title="What is libpcap"></a>What is libpcap</h2><blockquote>
<p>libpcap flow involving data copy from kernel to user space.</p>
</blockquote>
<p><img src="http://og2061b3n.bkt.clouddn.com/Packet_Capture_Flow_1.png" alt=""></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Compile with: gcc find_device.c -lpcap</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;pcap.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> \*\*argv)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span> \*device;</div><div class="line">    <span class="keyword">char</span> error_buffer[PCAP_ERRBUF_SIZE];</div><div class="line">    <span class="comment">//Find a device</span></div><div class="line">    device = pcap_lookupdev(error_buffer);</div><div class="line">    <span class="keyword">if</span> (device == <span class="literal">NULL</span>) &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Error finding device: %s\n"</span>, error_buffer);</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"Network device found: %s\n"</span>, device);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;pcap.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/if_ether.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_packet_info</span><span class="params">(<span class="keyword">const</span> u_char \*packet, struct pcap_pkthdr packet_header)</span></span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> \*argv[])</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span> \*device;</div><div class="line">    <span class="keyword">char</span> error_buffer[PCAP_ERRBUF_SIZE];</div><div class="line">    <span class="keyword">pcap_t</span> *handle;</div><div class="line">    <span class="keyword">const</span> u_char *packet;</div><div class="line">     <span class="class"><span class="keyword">struct</span> <span class="title">pcap_pkthdr</span> <span class="title">packet_header</span>;</span></div><div class="line">    <span class="keyword">int</span> packet_count_limit = <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> timeout_limit = <span class="number">10000</span>; <span class="comment">/*In milliseconds*/</span></div><div class="line"></div><div class="line">    device = pcap_lookupdev(error_buffer);</div><div class="line">    <span class="keyword">if</span> (device == <span class="literal">NULL</span>) &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Error finding device: %s\n"</span>, error_buffer);</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/*Open device for live capture*/</span></div><div class="line">    handle = pcap_open_live(</div><div class="line">            device,</div><div class="line">            BUFSIZ,</div><div class="line">            packet_count_limit,</div><div class="line">            timeout_limit,</div><div class="line">            error_buffer</div><div class="line">    );</div><div class="line"></div><div class="line">     <span class="comment">/*Attempt to capture one packet. If there is no network traffic</span></div><div class="line">      and the timeout is reached, it will return NULL*/</div><div class="line">     packet = pcap_next(handle, &amp;packet_header);</div><div class="line">     <span class="keyword">if</span> (packet == <span class="literal">NULL</span>) &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"No packet found.\n"</span>);</div><div class="line">        <span class="keyword">return</span> <span class="number">2</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/*Our function to output some info*/</span></div><div class="line">    print_packet_info(packet, packet_header);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_packet_info</span><span class="params">(<span class="keyword">const</span> u_char \*packet, struct pcap_pkthdr packet_header)</span> </span>&#123;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"Packet capture length: %d\n"</span>, packet_header.caplen);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"Packet total length %d\n"</span>, packet_header.len);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Debug-Tools"><a href="#Debug-Tools" class="headerlink" title="Debug Tools"></a>Debug Tools</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#Older versions of tcpdump truncate packets to 68 or 96 bytes.</span></div><div class="line"><span class="comment">#If this is the case, use -s to capture full-sized packets:</span></div><div class="line">$ tcpdump -i &lt;interface&gt; <span class="_">-s</span> 65535 -w &lt;some-file&gt;</div><div class="line"><span class="comment"># A packet capturing tool similar to TcpDump for Solaris</span></div><div class="line">$ snoop -r -o arp11.snoop -q <span class="_">-d</span> nxge0 -c 150000</div></pre></td></tr></table></figure>
<h4 id="tcpdump"><a href="#tcpdump" class="headerlink" title="tcpdump"></a>tcpdump</h4><p>tcpdump 是一个运行在命令行下的嗅探工具。它允许用户拦截和显示发送或收到过网络连接到该计算机的TCP/IP和其他数据包。它支持针对网络层、协议、主机、网络或端口的过滤，并提供and、or、not等逻辑语句来帮助你去掉无用的信息，从而使用户能够进一步找出问题的根源。可以使用 BPF 来限制tcpdump产生的数据包数量。</p>
<h4 id="snoop"><a href="#snoop" class="headerlink" title="snoop"></a>snoop</h4><p>snoop uses both the network packet filter and streams buffer modules to provide efficient capture of packets from the network. Captured packets can be displayed as they are received, or saved to a file for later inspection.</p>
<h4 id="promiscuous-mode"><a href="#promiscuous-mode" class="headerlink" title="promiscuous mode"></a>promiscuous mode</h4><p>抓包工具需要工作在promiscuous mode(混杂模式)（superuser）， 指一台机器的网卡能够接收所有经过它的数据流，而不论其目的地址是否是它。当网卡工作在混杂模式下时，网卡将来自接口的所有数据都捕获并交给相应的驱动程序。一般在分析网络数据作为网络故障诊断手段时用到，同时这个模式也被网络黑客利用来作为网络数据窃听的入口。</p>
<h4 id="BPF"><a href="#BPF" class="headerlink" title="BPF"></a>BPF</h4><p>Berkeley Packet Filter，缩写BPF，是类Unix系统上数据链路层的一种接口，提供原始链路层封包的收发。BPF支持“过滤”封包，这样BPF会只把“感兴趣”的封包到上层软件，可以避免从操作系统内核向用户态复制其他封包，降低抓包的CPU的负担以及所需的缓冲区空间，从而减少丢包率。BPF的过滤功能是以BPF虚拟机机器语言的解释器的形式实现的，这种语言的程序可以抓取封包数据，对封包中的数据采取算术操作，并将结果与常量或封包中的数据或结果中的测试位比较，根据比较的结果决定接受还是拒绝封包。</p>
<p><img src="http://og2061b3n.bkt.clouddn.com/Packet_Capture_BPF.png" alt="BPF Overview"></p>
<h2 id="Go-Packet"><a href="#Go-Packet" class="headerlink" title="Go Packet"></a>Go Packet</h2><h3 id="Find-Devices"><a href="#Find-Devices" class="headerlink" title="Find  Devices"></a>Find  Devices</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> main</div><div class="line"></div><div class="line"><span class="keyword">import</span> (</div><div class="line">	<span class="string">"fmt"</span></div><div class="line">	<span class="string">"log"</span></div><div class="line">	<span class="string">"github.com/google/gopacket"</span></div><div class="line">	<span class="string">"github.com/google/gopacket/layers"</span></div><div class="line">	<span class="string">"github.com/google/gopacket/pcap"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">	fmt.Println(<span class="string">"----------Find all devices---------\n "</span>)</div><div class="line"></div><div class="line">	devices, err := pcap.FindAllDevs()</div><div class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">		log.Fatal(err)</div><div class="line">	&#125;</div><div class="line">	<span class="comment">// Print device information</span></div><div class="line">	<span class="keyword">for</span> _, device := <span class="keyword">range</span> devices &#123;</div><div class="line">		<span class="keyword">for</span> _, address := <span class="keyword">range</span> device.Addresses &#123;</div><div class="line">			fmt.Println(<span class="string">"- IP address: "</span>, address.IP)</div><div class="line">			fmt.Println(<span class="string">"- Subnet mask: "</span>, address.Netmask)</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">/*- IP address:  45.33.110.101</span></div><div class="line">	  - Subnet mask:  ffffff00</div><div class="line">	  - IP address:  2600:3c01::f03c:91ff:fee5:45b6</div><div class="line">	  - Subnet mask:  ffffffffffffffff0000000000000000</div><div class="line">	  - IP address:  fe80::f03c:91ff:fee5:45b6</div><div class="line">	  - Subnet mask:  ffffffffffffffff0000000000000000</div><div class="line">	  - IP address:  127.0.0.1</div><div class="line">	  - Subnet mask:  ff000000</div><div class="line">	  - IP address:  ::1</div><div class="line">	  - Subnet mask:  ffffffffffffffffffffffffffffffff</div><div class="line">	*/</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Decoding-Packet-Layers"><a href="#Decoding-Packet-Layers" class="headerlink" title="Decoding Packet Layers"></a>Decoding Packet Layers</h3><p><img src="http://og2061b3n.bkt.clouddn.com/Packet_Capture_Flow_2.png" alt=""></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> main</div><div class="line"></div><div class="line"><span class="keyword">import</span> (</div><div class="line">	<span class="string">"fmt"</span></div><div class="line">	<span class="string">"log"</span></div><div class="line">	<span class="string">"net"</span></div><div class="line">	<span class="string">"github.com/google/gopacket"</span></div><div class="line">	<span class="string">"github.com/google/gopacket/layers"</span></div><div class="line">	<span class="string">"github.com/google/gopacket/pcap"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line"></div><div class="line">	handle, err := pcap.OpenLive(<span class="string">"eth0"</span>, <span class="number">65536</span>, <span class="literal">true</span>, pcap.BlockForever)</div><div class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">		fmt.Printf(<span class="string">"Error: %s\n"</span>, err)</div><div class="line">		<span class="keyword">return</span></div><div class="line">	&#125;</div><div class="line">	<span class="keyword">defer</span> handle.Close()</div><div class="line"></div><div class="line">	<span class="comment">//Create a new PacketDataSource</span></div><div class="line">	src := gopacket.NewPacketSource(handle, layers.LayerTypeEthernet)</div><div class="line">	<span class="comment">//Packets returns a channel of packets</span></div><div class="line">	in := src.Packets()</div><div class="line"></div><div class="line">	<span class="keyword">for</span> &#123;</div><div class="line">		<span class="keyword">var</span> packet gopacket.Packet</div><div class="line">		<span class="keyword">select</span> &#123;</div><div class="line">		<span class="comment">//case &lt;-stop:</span></div><div class="line">		<span class="comment">//return</span></div><div class="line">		<span class="keyword">case</span> packet = &lt;-in:</div><div class="line">			arpLayer := packet.Layer(layers.LayerTypeARP)</div><div class="line">			<span class="keyword">if</span> arpLayer == <span class="literal">nil</span> &#123;</div><div class="line">				<span class="keyword">continue</span></div><div class="line">			&#125;</div><div class="line">			arp := arpLayer.(*layers.ARP)</div><div class="line"></div><div class="line">			<span class="keyword">if</span> net.HardwareAddr(arp.SourceHwAddress).String() == <span class="string">"abc"</span> &#123;</div><div class="line">				<span class="comment">//Do something or don't</span></div><div class="line">			&#125;</div><div class="line"></div><div class="line">			tcpLayer := packet.Layer(layers.LayerTypeTCP)</div><div class="line">			<span class="keyword">if</span> tcpLayer == <span class="literal">nil</span> &#123;</div><div class="line">				<span class="keyword">continue</span></div><div class="line">			&#125;</div><div class="line">			tcp := tcpLayer.(*layers.TCP)</div><div class="line"></div><div class="line">			......</div><div class="line"></div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Creating-and-Sending-Packets"><a href="#Creating-and-Sending-Packets" class="headerlink" title="Creating and Sending Packets"></a>Creating and Sending Packets</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> main</div><div class="line"></div><div class="line"><span class="keyword">import</span> (</div><div class="line">    <span class="string">"github.com/google/gopacket"</span></div><div class="line">    <span class="string">"github.com/google/gopacket/layers"</span></div><div class="line">    <span class="string">"github.com/google/gopacket/pcap"</span></div><div class="line">    <span class="string">"log"</span></div><div class="line">    <span class="string">"net"</span></div><div class="line">    <span class="string">"time"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">var</span> (</div><div class="line">    device       <span class="keyword">string</span> = <span class="string">"eth0"</span></div><div class="line">    snapshot_len <span class="keyword">int32</span>  = <span class="number">1024</span></div><div class="line">    promiscuous  <span class="keyword">bool</span>   = <span class="literal">false</span></div><div class="line">    err          error</div><div class="line">    timeout      time.Duration = <span class="number">30</span> * time.Second</div><div class="line">    handle       *pcap.Handle</div><div class="line">    buffer       gopacket.SerializeBuffer</div><div class="line">    options      gopacket.SerializeOptions</div><div class="line">)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="comment">// Open device</span></div><div class="line">    handle, err = pcap.OpenLive(device, snapshot_len, promiscuous, timeout)</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;log.Fatal(err) &#125;</div><div class="line">    <span class="keyword">defer</span> handle.Close()</div><div class="line"></div><div class="line">    <span class="comment">// Send raw bytes over wire</span></div><div class="line">    rawBytes := []<span class="keyword">byte</span>&#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>&#125;</div><div class="line">    err = handle.WritePacketData(rawBytes)</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        log.Fatal(err)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// Create a properly formed packet, just with</span></div><div class="line">    <span class="comment">// empty details. Should fill out MAC addresses,</span></div><div class="line">    <span class="comment">// IP addresses, etc.</span></div><div class="line">    buffer = gopacket.NewSerializeBuffer()</div><div class="line">    gopacket.SerializeLayers(buffer, options,</div><div class="line">        &amp;layers.Ethernet&#123;&#125;,</div><div class="line">        &amp;layers.IPv4&#123;&#125;,</div><div class="line">        &amp;layers.TCP&#123;&#125;,</div><div class="line">        gopacket.Payload(rawBytes),</div><div class="line">    )</div><div class="line">    outgoingPacket := buffer.Bytes()</div><div class="line">    <span class="comment">// Send our packet</span></div><div class="line">    err = handle.WritePacketData(outgoingPacket)</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        log.Fatal(err)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// This time lets fill out some information</span></div><div class="line">    ipLayer := &amp;layers.IPv4&#123;</div><div class="line">        SrcIP: net.IP&#123;<span class="number">127</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;,</div><div class="line">        DstIP: net.IP&#123;<span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>&#125;,</div><div class="line">    &#125;</div><div class="line">    ethernetLayer := &amp;layers.Ethernet&#123;</div><div class="line">        SrcMAC: net.HardwareAddr&#123;<span class="number">0xFF</span>, <span class="number">0xAA</span>, <span class="number">0xFA</span>, <span class="number">0xAA</span>, <span class="number">0xFF</span>, <span class="number">0xAA</span>&#125;,</div><div class="line">        DstMAC: net.HardwareAddr&#123;<span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>&#125;,</div><div class="line">    &#125;</div><div class="line">    tcpLayer := &amp;layers.TCP&#123;</div><div class="line">        SrcPort: layers.TCPPort(<span class="number">4321</span>),</div><div class="line">        DstPort: layers.TCPPort(<span class="number">80</span>),</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// And create the packet with the layers</span></div><div class="line">    buffer = gopacket.NewSerializeBuffer()</div><div class="line">    gopacket.SerializeLayers(buffer, options,</div><div class="line">        ethernetLayer,</div><div class="line">        ipLayer,</div><div class="line">        tcpLayer,</div><div class="line">        gopacket.Payload(rawBytes),</div><div class="line">    )</div><div class="line">    outgoingPacket = buffer.Bytes()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Capture-Packet-Workflow"><a href="#Capture-Packet-Workflow" class="headerlink" title="Capture Packet Workflow"></a>Capture Packet Workflow</h4><ul>
<li>Getting a list of network devices</li>
<li>Capturing packets from a network device</li>
<li>Analyzing packet layers</li>
<li>Using Berkeley Packet Filters</li>
</ul>
<p><img src="http://og2061b3n.bkt.clouddn.com/Network_Protocol_Packet.png" alt=""></p>
<h2 id="Demo-amp-Repository"><a href="#Demo-amp-Repository" class="headerlink" title="Demo &amp; Repository"></a>Demo &amp; Repository</h2><ul>
<li><a href="http://www.devdungeon.com/content/using-libpcap-c" target="_blank" rel="external">using libpcap c</a></li>
<li><a href="http://www.binarytides.com/packet-sniffer-code-c-libpcap-linux-sockets" target="_blank" rel="external">packet sniffer code c</a></li>
<li><a href="https://www.scalawilliam.com/scala-native-libpcap" target="_blank" rel="external">scala native libpcap</a></li>
<li><a href="https://godoc.org/github.com/google/gopacket" target="_blank" rel="external">gopacket</a></li>
<li><a href="https://libraries.io/github/open-ch/goProbe" target="_blank" rel="external">goProbe</a></li>
</ul>
<h2 id="Application"><a href="#Application" class="headerlink" title="Application"></a>Application</h2><ul>
<li><a href="https://github.com/zond/qisniff" target="_blank" rel="external">qisniff</a></li>
<li><a href="https://riboseyim.github.io/2016/04/26/Ntopng/" target="_blank" rel="external">新一代Ntopng网络流量监控—可视化和架构分析</a></li>
<li><a href="http://www.ntop.org/products/packet-capture/pf_ring/" target="_blank" rel="external">ntop:pf_ring</a></li>
<li><a href="http://www.ntop.org/products/packet-capture/pf_ring/pf_ring-zc-zero-copy/" target="_blank" rel="external">ntop:pf_ring zero copy</a></li>
<li><a href="http://jaseywang.me/2015/01/22/pf_ring-%E5%AF%B9%E7%BD%91%E7%BB%9C%E6%8A%93%E5%8C%85%E6%80%A7%E8%83%BD%E7%9A%84%E6%8F%90%E5%8D%87%E4%B8%8D%E4%BB%85%E4%BB%85%E6%98%AF-30-40/" target="_blank" rel="external">jaseywang:pf_ring对网络抓包性能的提升</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA4Nzg5Nzc5OA==&amp;mid=2651659827&amp;idx=1&amp;sn=3324025e2f4fb2c494676bf01d67427f&amp;scene=1&amp;srcid=0525Wyio4YnzoUz9oJ60Zmdu#rd" target="_blank" rel="external">胥峰(盛大游戏)：网络分析技术之葵花宝典</a></li>
<li><a href="https://segmentfault.com/a/1190000007967510" target="_blank" rel="external">基于网络抓包实现kubernetes中微服务的应用级监控</a></li>
</ul>
<h2 id="拓展话题：SDN-网络中的可视化与数据封包"><a href="#拓展话题：SDN-网络中的可视化与数据封包" class="headerlink" title="拓展话题：SDN 网络中的可视化与数据封包"></a>拓展话题：SDN 网络中的可视化与数据封包</h2><ul>
<li>DPDK(Data Plane Development Kit)<br>运行于Intel X86平台，是 Intel 开源的一组快速处理数据包的开发平台及接口（BSD）。重载了网卡驱动，该驱动在收到数据包后不中断通知CPU，而是将数据包通过零拷贝技术存入内存，这时应用层程序就可以通过DPDK提供的接口，直接从内存读取数据包。这种处理方式节省了CPU中断时间、内存拷贝时间，并向应用层提供了简单易行且高效的数据包处理方式，使得网络应用的开发更加方便。</li>
</ul>
<h2 id="专题合辑：Network-Engineering"><a href="#专题合辑：Network-Engineering" class="headerlink" title="专题合辑：Network Engineering"></a>专题合辑：Network Engineering</h2><ul>
<li><a href="https://riboseyim.github.io/2017/05/12/SDN/" target="_blank" rel="external">SDN 技术指南（一）: 架构概览</a></li>
<li><a href="https://riboseyim.github.io/2017/08/22/SDN-OpenFlow/" target="_blank" rel="external">SDN 技术指南（二）：OpenFlow</a></li>
<li>Preview <a href="https://riboseyim.github.io/2017/10/16/SDN-Controller/" target="_blank" rel="external">SDN 技术指南（三）：OpenDaylight or Floodlight ?</a></li>
<li><a href="https://riboseyim.github.io/2017/10/13/SDN-OpenvSwitch/" target="_blank" rel="external">SDN 技术指南（四）：Open vSwitch</a></li>
<li>Preview <a href="#">SDN 技术指南（五）：NFV</a></li>
<li>Preview <a href="#">SDN 技术指南（六）：OpenStack or Kubernetes ? </a></li>
<li><a href="https://riboseyim.github.io/2017/07/14/sFlow/" target="_blank" rel="external">浅谈基于数据分析的网络态势感知</a></li>
<li><a href="https://riboseyim.github.io/2017/06/16/Pcap/" target="_blank" rel="external">网络数据包的捕获与分析（libpcap、BPF及gopacket）</a></li>
<li><a href="https://riboseyim.github.io/2016/04/26/Ntopng/" target="_blank" rel="external">新一代Ntopng网络流量监控—可视化和架构分析</a></li>
<li><a href="https://riboseyim.github.io/2017/08/09/IPv6/" target="_blank" rel="external">Cyber-Security: IPv6 &amp; Security</a></li>
<li><a href="https://riboseyim.github.io/2017/07/23/CloudComputing/" target="_blank" rel="external">AWS or Azure : 云计算平台的趋势分析|Stack Overflow,2017</a></li>
<li><a href="https://riboseyim.github.io/2017/04/09/CSTCB/" target="_blank" rel="external">Cyber-Security|香港警务处网络安全与科技罪案总警司</a></li>
</ul>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="http://www.devdungeon.com/content/packet-capture-injection-and-analysis-gopacket" target="_blank" rel="external">(推荐)Packet Capture, Injection, and Analysis with Gopacket</a></li>
<li><a href="http://www.tcpdump.org/papers/bpf-usenix93.pdf" target="_blank" rel="external">(推荐)The BSD Packet Filter:A New Architecture for User-level Packet Capture</a></li>
<li><a href="http://recursos.aldabaknocking.com/libpcapHakin9LuisMartinGarcia.pdf" target="_blank" rel="external">Programming with Libpcap - Sniffing the Network From Our Own Application </a></li>
<li><a href="https://docs.oracle.com/cd/E23824_01/html/821-1453/gexkw.html" target="_blank" rel="external">docs.oracle:Monitoring Packet Transfers With the snoop Command</a></li>
<li><a href="http://www.freebuf.com/articles/web/85129.html" target="_blank" rel="external">MOTS(Man-on-the-Side)：一种隐秘的攻击</a></li>
<li><a href="https://blog.fox-it.com/2015/04/20/deep-dive-into-quantum-insert/" target="_blank" rel="external">(推荐)Deep dive into QUANTUM INSERT</a></li>
<li><a href="https://www.youtube.com/watch?v=JZDiQ6f_TRs" target="_blank" rel="external">YouTube:Capturing with Wireshark’s tshark</a></li>
<li><a href="http://www.linuxjournal.com/content/using-tshark-watch-and-inspect-network-traffic" target="_blank" rel="external">Using tshark to Watch and Inspect Network Traffic</a></li>
<li><a href="https://mp.weixin.qq.com/s/7pxG4EEliIXbOgO27unBTQ" target="_blank" rel="external">tcpdump：理论、自动抓包及业务架构树的生成</a></li>
</ul>

      

    </div>
    
  </div>
  
    <div class="article-entry" itemprop="articleBody">
      <p>
        更多精彩内容扫码关注公众号,RiboseYim's Blog：<a href="https://riboseyim.github.io" target="_blank" rel="external">https://riboseyim.github.io</a>
        <br>
        <a href="http://o8m8ngokc.bkt.clouddn.com/ID_RiboseYim_201706.png" title="微信公众号@睿哥杂货铺" rel="fancy-group" class="fancy-ctn fancybox">
          <img src="http://o8m8ngokc.bkt.clouddn.com/ID_RiboseYim_201706.png" title="微信公众号@睿哥杂货铺">
          <img src="http://o8m8ngokc.bkt.clouddn.com/quanzi-rui-small.png" title="睿哥读书会">
        </a>
      </p>
    </div>
    
<nav id="article-nav">
  
    <a href="/2017/06/19/Language-Python-lang/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          玩转编程语言:Python
        
      </div>
    </a>
  
  
    <a href="/2017/06/14/Mathmetics/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Catalog:数学与算法</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		  <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" target="_blank">Copyright 2016-2018 RiboseYim
      授权：保持署名-非商业性使用-禁止演绎| License BY-NC-ND 4.0 </a>
    </div>
      	<div class="footer-right">
      		<a href="https://riboseyim.github.io/2016/05/31/AboutMe/" target="_blank">聪明秀出谓之英，胆力过人谓之雄 | 联系作者 </a>
      	</div>
    </div>
  </div>
</footer>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1258500076'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s4.cnzz.com/z_stat.php%3Fid%3D1258500076%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>

    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: true
	}
</script>
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  </div>
</body>
</html>